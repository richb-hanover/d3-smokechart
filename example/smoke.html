<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Small demo for d3-smokechart library" />
    <title>D3-Smokechart demo</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
<!--    <h3>Using selection.call(obj.chart, args)</h3>-->
<!--    <div id="smokeTest1" style="height: 300px; width:1050px;"></div>-->
    <h3>Using obj.line(N) and obj.smokeBands(M)</h3>
    <div id="smokeTest2"></div>
  </body>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="http://localhost:3000/umd/d3-smokechart.js"></script>
<!--  <script src="http://localhost:3000/../Raw Data Samples/TMI-Pings-from-VideoDeluxe.js"></script>-->
<!--  <script src="http://localhost:3000/../Raw Data Samples/perfectcone.js"></script>-->
  <script>
    // prettier-ignore
    // const smokeData = [
    //   [164,165,167,184,193,240], [152,155,161,162,170,273], [154,158,158,159,161,163], [166,167,173,174,174,220], [161,162,164,167,167,274],
    //   [160,162,162,164,171,206], [162,163,163,165,168,194], [160,164,166,168,174,178], [161,169,171,176,177,187], [137,148,159,166,170,171],
    //   [161,164,165,168,169,170], [163,166,167,169,169,170], [161,161,167,168,179,253], [177,178,179,191,197,299], [149,150,166,168,190,247],
    //   [123,165,166,181,190,238], [141,147,168,178,178,185], [178,181,182,184,195,218], [166,177,185,196,200,263], [162,164,165,165,168,211],
    //   [143,145,156,159,161,254], [148,150,150,155,155,219], [149,154,163,164,165,167], [162,165,165,169,215,250], [160,164,167,167,175,186],
    //   [162,162,164,167,30,77], [28,29,29,31,32,38], [31,31,32,32,33,45], [123,129,134,152,91,93], [133,140,155,160,162,259],
    //   [154,155,158,159,160,241], [118,125,144,147,150,199], [137,148,149,150,151,177], [151,151,152,153,159,269], [151,151,169,175,176,256],
    //   [165,168,174,174,175,176], [173,173,173,179,184,276], [170,171,177,177,183,188], [174,175,176,178,178,270], [168,174,177,179,181,259],
    //   [128,153,162,172,174,191], [160,164,166,167,169,170], [155,156,157,157,162,234], [151,156,157,163,169,173], [165,165,170,178,178,284],
    //   [161,162,165,166,246,698], [147,148,148,156,160,165], [141,146,148,151,153,154], [158,162,169,170,170,255], [102,118,162,166,168,181],
    //   [113,126,151,159,248,70], [158,162,162,170,232], [146,159,162,164,165,165], [110,167,171,172], [114,149,161,162,170,197],
    //   [155,161,166,167,169,247], [161,163,163,167,170,252], [162,165,166,173,178,243], [161,169,175,176,178,181], [165,166,167,171,171,171],
    //   [163,164,164,166,168,187], [165,167,168,170,172,182], [163,163,166,166,168,179], [172,172,173,175,184,225], [164,166,166,167,174,182],
    //   [160,161,163,171,172,200], [165,166,166,167,169,263], [170,171,171,173,176,177], [149,157,157,161,165,165], [162,162,163,169,171,255],
    //   [160,165,166,167,169,170], [167,167,170,171,174,202], [162,163,163,163,168,169], [113,122,140,146,153,157], [162,165,168,168,170,222],
    //   [165,169,172,174,185,186], [164,164,166,167,172,173], [162,168,168,171,185,185], [1054,115,134,135,167,96], [144,31,33,36,63,74],
    //   [105,112,170,180,30,33], [31,32,33,35,45,53], [30,31,32,32,32,32], [143,262,32,43,49,95], [30,30,31,32,32,33],
    //   [27,30,30,31,31,87], [113,121,127,128,31,73], [111,112,137,138,147,148], [137,144,146,150,154,165], [144,145,149,150,154,216],
    //   [154,154,158,159,160,189], [158,160,161,162,169,266], [164,165,166,167,170,170], [157,159,160,161,161,192], [156,157,158,158,158,160],
    //   [154,158,162,175,183,222], [156,156,157,158,165,223], [159,164,167,168,170,171], [160,161,163,168,228], [163,163,164,165,166,169],
    //   [161,162,163,168,172,187], [160,163,163,166,183,276], [118,126,163,178,186,68], [114,153,158,178,43,63], [122,55,56,85,86,96],
    // ]

    // smokeData = [
    //   [ 50 ],
    //   [ 49, 50, 51 ],
    //   [ 48, 49, 50, 51, 52 ],
    //   [ 47, 48, 49, 50, 51, 52, 53],
    //   [ 46, 47, 48, 49, 50, 51, 52, 53, 54],
    //   [ 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55],
    //   [ 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56],
    //   [ 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57],
    //   [ 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58],
    //   [ 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59],
    //   [ 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60],
    //   [ 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61],
    //   [ 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62],
    //   [ 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63],
    //   [ 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64],
    //   [ 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65],
    //   [ 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66],
    //   [ 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67],
    //   [ 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68],
    //   [ 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69],
    //   [ 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70],
    //   [ 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71],
    //   [ 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72],
    //   [ 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73]
    // ]

    smokeData = [
     // [100],
      [0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230,235,240,245,250,255,260,265,270,275,280,285,290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380,385,390,395,400,405,410,415,420,425,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500 ]
      // , [100]
      // , [200]
    ]
    // smokeData = [
    //   [206,206,201,201,200,200,202,204,202,205,203,205,203,205,202,202,201,200,203,202,199,201,205,207,199,204,205,206,217,202,200,198,203,209,207,201,201,221,228,220,202,229,202,204,217,201,201,221,200,206,203,205,200,354,204,205,203,200,204,204,202,266,201,219,213,205,201,208,203,202,206,213,207,213,207,215,205,481,202,202]
    //   ,[106,106,101,101,100,100,102,104,102,105,103,105,103,105,102,102,101,100,103,102,199,101,105,107,199,104,105,106,217,102,100,198,103,109,107,101,101,221,228,220,102,229,102,104,217,101,101,221,100,106,103,105,100,354,104,105,103,100,104,104,102,266,101,219,213,105,101,108,103,102,106,113,107,113,107,115,105,381,102,102]
    //   ,[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230,235,240,245,250,255,260,265,270,275,280,285,290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380,385,390,395,400,405,410,415,420,425,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500 ]
    //   // , [200]
    //   // ,[150, 200, 250 ]
    //   // ,[150, 175, 200, 225, 250 ]
    // ]
    const scaleX = d3.scaleLinear([50, 1000])
    const scaleY = d3.scaleLinear([290, 10])

    const smoker = d3.Smokechart(smokeData, { scaleX, scaleY })
            // .data(smokeData)
            .adjustScaleRange()
    const errors = smoker.countErrors()
    // console.log (JSON.stringify(typeof smoker))

    // console.log(d3.quantile(smokeData[2], 0.2));

    // let height = document.getElementById("smokeTest1").style.height
    // let width  = document.getElementById("smokeTest1").style.width;

    // Call the built-in method to create the smokechart
    // const test1 = d3.select("#smokeTest1").append("svg").attr("width", width).attr("height", height)
    // test1.append("g").call(smoker.chart, { mode: "smoke", bands: 5, errors: false })

    // Call individual methods to build the smokechart "by hand"
    const test2 = d3.select("#smokeTest2").append("svg").attr("width", 1050).attr("height", 300)
    const g = test2.append("g")
    g.selectAll("path.smokeBand")
      .data(smoker.smokeBands([ [0, 1], [0.05, 0.95], [0.45, 0.55] ]))
      .enter()
      .append("path")
      .classed("smokeBand", true)
      .attr("fill", function(d, i) {return smoker.fillSmoke(d,i)})
      .attr("d", d => d)

    g.selectAll("path.midLine")
      .data(smoker.line(0.5))
      .enter()
      .append("path")
      .classed("midLine", true)
      .attr("stroke", "#00cc00")
      .attr("stroke-width", 2)
      .attr("fill", "transparent")
      .attr("d", d => d)

    // g.selectAll("circle.errMarker")
    //   .data(errors)
    //   .enter()
    //   .append("circle")
    //   .attr("cx", d => d.x)
    //   .attr("cy", d => 8 + d.errPos * 8.5)
    //   .attr("r", 4)
    //   .attr("fill", "#f30")
  </script>
</html>
